@page "/custWorkInfo"
@using BitTagDAL
@using BitTagModels
@using BitTagUser.CutomerServices;
@inject ICustomerWorkInfo custWorkinfo
@inject IOrgs org


@*<EditForm Model="customerWorkInfo" OnSubmit="SaveCustWorkInfo">
    <label>Organization</label>
    @*<input type="text" @bind-value="vehicle.vehicleMake" /><br />*@
    @*<select @onchange="SeletedOrgID">
        @foreach (var item in organizations)
        {
            <option value="@item.orgID">@item.orgName</option>
        }
    </select>
    <label>Work Type</label>
    <input type="text" @bind-value="customerWorkInfo.WorkType" />
    <label>Designtion</label>
    <input type="text" @bind-value="customerWorkInfo.Desig" />
    <label>Work time</label>
    <input type="text" @bind-value="customerWorkInfo.worktime" />
    <button type="submit">Save</button>
</EditForm>*@

<div class="container container-fluid mt-5">
    <div class="card bg-white">
        <article class="card-body mx-auto" style="max-width: 400px;">
            <h4 class="text-center fw-bold">Work Information</h4>
            <EditForm Model="customerWorkInfo" OnSubmit="SaveCustWorkInfo">
                <div class="form-group input-group mb-1 mt-4">
                    <div class="input-group-prepend">
                        <span class="input-group-text"> Organization </span>
                    </div>
                    <select @onchange="SeletedOrgID">
                        @foreach (var item in organizations)
                        {
                            <option value="@item.orgID">@item.orgName</option>
                        }
                    </select>
                    <div class="input-group-prepend">
                        <span class="input-group-text"> <i class="oi oi-briefcase"></i> </span>
                    </div>
                    <input class="form-control" placeholder="Work Type" type="text" @bind-value="customerWorkInfo.WorkType" required>
                </div> <!-- form-group// -->
                <div class="form-group input-group mb-1">
                    <div class="input-group-prepend">
                        <span class="input-group-text"> <i class="oi oi-briefcase"></i> </span>
                    </div>
                    <input class="form-control" placeholder="Designation" type="text" @bind-value="customerWorkInfo.Desig" required>
                    <div class="input-group-prepend">
                        <span class="input-group-text"> Work Time </span>
                    </div>
                    <input class="form-control"  type="time" @bind-value="customerWorkInfo.worktime" required>
                </div> <!-- form-group// -->
                

                <div class="form-group" style="display:flex; justify-content:center;">
                    <button type="submit" class="btn btn-primary btn-block"> Register  </button>
                </div> <!-- form-group// -->
            </EditForm>
        </article>
    </div> <!-- card.// -->

</div>
@code {
    CustomerWorkInfoModel customerWorkInfo = new CustomerWorkInfoModel();
    List<CustomerWorkInfoModel> workinfos = new List<CustomerWorkInfoModel>();

    List<OrganizationModel> organizations = new List<OrganizationModel>();
    Guid orgId { get; set; }

    string userid = "3fa85f64-5717-4562-b3fc-2c963f66afad";
    private async void SaveCustWorkInfo()
    {
        customerWorkInfo.userID_FK = Guid.Parse(userid);
        customerWorkInfo.org_FK = orgId;
        await custWorkinfo.SaveCustomerWorkInfo(customerWorkInfo);
    }
    //private async Task LoadData()
    //{
    //    organizations = await org.Getorgs();
    //}
    private void SeletedOrgID(ChangeEventArgs e)
    {
        orgId = Guid.Parse(e.Value.ToString());
    }
    protected override async Task OnInitializedAsync()
    {

        organizations = await org.Getorgs();
    }
}
